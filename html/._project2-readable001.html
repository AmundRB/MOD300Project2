<!--
File automatically generated using DocOnce (https://github.com/doconce/doconce/):
doconce format html project2.do.txt LANG=C.UTF-8 --html_style=bootswatch_readable --html_output=project2-readable --html_code_style=inherit
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/doconce/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="Modeling the Worst: A Zombie and Ebola outbreak">
<title>Modeling the Worst: A Zombie and Ebola outbreak</title>
<!-- Bootstrap style: bootswatch_readable -->
<!-- doconce format html project2.do.txt LANG=C.UTF-8 --html_style=bootswatch_readable --html_output=project2-readable --html_code_style=inherit -->
<link href="https://netdna.bootstrapcdn.com/bootswatch/3.1.1/readable/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->
<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }
/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}
/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:64px;      /* fixed header height for style bootswatch_readable */
  margin:-64px 0 0; /* negative fixed header height */
}
</style>
</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [('Table of contents',
               1,
               'table_of_contents',
               'table_of_contents'),
              ('Introduction',
               1,
               'intro_compartment_models',
               'intro_compartment_models'),
              ('Modeling a zombie outbreak - $SZ$ model',
               1,
               None,
               'modeling-a-zombie-outbreak-sz-model'),
              ('Exercise 1: No hope?', 1, 'no_hope', 'no_hope'),
              ('Exercise 2: Numerical solver implementation',
               1,
               None,
               'exercise-2-numerical-solver-implementation'),
              ('Exercise 3: Predicting the fate of Sokndal and Dirdal',
               1,
               'fate_of_dirdal_and_sokndal',
               'fate_of_dirdal_and_sokndal'),
              ('Exercise 4: Counter attacks - Kill them all?',
               1,
               'SIR_model',
               'SIR_model'),
              ('Exercise 5: Ebola epidemic in West Africa',
               1,
               'ebola',
               'ebola'),
              ('Guidelines for project submission',
               1,
               None,
               'guidelines-for-project-submission'),
              ('Bibliography', 1, None, 'bibliography')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="project2-readable.html">Modeling the Worst: A Zombie and Ebola outbreak</a>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._project2-readable000.html#table_of_contents" style="font-size: 80%;">Table of contents</a></li>
     <!-- navigation toc: --> <li><a href="#intro_compartment_models" style="font-size: 80%;">Introduction</a></li>
     <!-- navigation toc: --> <li><a href="#modeling-a-zombie-outbreak-sz-model" style="font-size: 80%;">Modeling a zombie outbreak - \( SZ \) model</a></li>
     <!-- navigation toc: --> <li><a href="#no_hope" style="font-size: 80%;">Exercise 1: No hope?</a></li>
     <!-- navigation toc: --> <li><a href="#exercise-2-numerical-solver-implementation" style="font-size: 80%;">Exercise 2: Numerical solver implementation</a></li>
     <!-- navigation toc: --> <li><a href="#fate_of_dirdal_and_sokndal" style="font-size: 80%;">Exercise 3: Predicting the fate of Sokndal and Dirdal</a></li>
     <!-- navigation toc: --> <li><a href="#SIR_model" style="font-size: 80%;">Exercise 4: Counter attacks - Kill them all?</a></li>
     <!-- navigation toc: --> <li><a href="#ebola" style="font-size: 80%;">Exercise 5: Ebola epidemic in West Africa</a></li>
     <!-- navigation toc: --> <li><a href="#guidelines-for-project-submission" style="font-size: 80%;">Guidelines for project submission</a></li>
     <!-- navigation toc: --> <li><a href="#bibliography" style="font-size: 80%;">Bibliography</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->
<div class="container">
<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->
<a name="part0001"></a>
<!-- !split -->
<h1 id="intro_compartment_models" class="anchor">Introduction</h1>

<p>In this project we are modeling the worst, but expecting (solving for) the
best. What might happen if zombies invade a little village in Norway, and
how much time do the inhabitants have to postpone or prevent the apocalypse?
After modeling zombies, we will apply the same kind of mathematical model to
real data for outbreaks of the Ebola virus in West Africa (2014-2016).
</p>

<center> <!-- figure label: --> <div id="fig:p3:wkd"></div> <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 1: Prepare for the worst (From the AMC show ''The Walking Dead'')  <!-- caption label: fig:p3:wkd --></p>
</center>
<p><img src="fig-project2/wkd.png" width="800" align="bottom"></p>
</center>

<div class="alert alert-block alert-success alert-text-normal"><b><font color="white">Before we start:</font></b>
<p><font color="white">In this project, more than any other, you have to have control over numerical
uncertainty, and instabilities - your very future may depend on it!</font>
</p>
</div>

<h1 id="modeling-a-zombie-outbreak-sz-model" class="anchor">Modeling a zombie outbreak - \( SZ \) model </h1>

<p>All of our mathematical models will be deterministic
<em>compartment models</em> <a href="#kermack1927contribution">[1]</a>.
We let go of detailed descriptions, to gain equations that are mathematical
tractable. Assume for simplicity that we only have two
groups (compartments) of individuals:
</p>

<ol>
<li> \( S \) - Susceptible: humans that are exposed to being turned into a zombie.</li>
<li> \( Z \) - Zombies, humans that have been bitten or scratched by zombies.</li>
</ol>
<center> <!-- figure label: --> <div id="fig:human_zombies"></div> <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 2: A two-compartment model. Note that only transport from the class of exposed humans to zombies are allowed. Zombies are <em>never</em> cured, if you are bitten you are dead, dead, dead, ...  <!-- caption label: fig:human_zombies --></p>
</center>
<p><img src="fig-project2/ZI.png" width="800" align="bottom"></p>
</center>

<p>The compartments are assumed to be <em>well mixed</em>, meaning that pairs of
individuals in the population interact with <em>equal probability</em>.
To develop a mathematical model, we need to estimate the rate of flow
between the two compartments in figure <a href="#fig:human_zombies">2</a>.
During a time interval \( \Delta{t} \), a certain number of human-zombie pairs
will meet, and in each such encounter there is a chance that the
human is infected. Let \( \mathcal{C}(N) \) be the rate at which <em>any</em>
individual in the population contacts another individual, i.e., the average
number of contacts made per unit time. Since at time \( t \) there are \( Z(t) \)
zombies, we assume the probability of meeting a zombie is \( Z(t)/N \). Finally,
let \( p_Z \) denote the probability that a human-zombie encounter results in
an infection. Then, we can model the reduction in the human population going
from time \( t \) to \( t+\Delta t \) as
</p>
$$
\begin{equation}
S(t+\Delta t)-S(t)=-\beta\cdot\Delta t\cdot\frac{Z(t)}{N}\cdot{S(t)}\,,
\tag{1}
\end{equation}
$$

<p>where we have defined \( \beta=p_{Z}\cdot{\mathcal{C}(N)} \).</p>

<div class="alert alert-block alert-success alert-text-normal"><b><font color="white">Notice</font></b>
<p><font color="white">We have here assumed the contact-rate
to be a constant independent of population size. Other assumptions are
possible, and care should be taken when interpreting results from the
literature <a href="#begon2002clarification">[2]</a>.</font>
</p>
</div>


<p>The \( \beta \) factor implicitly contains a lot of biomedical, physical, and
sociological factors; for example, if the humans are unfit, they might not be able to
escape the zombies.
In the beginning of a zombie outbreak, \( \beta \) is likely to be large, because
humanity might not understand the severity of the situation, or they may be
in denial. Thus, \( \beta \) is most likely a time dependent parameter, which
will decrease once humans start to realize that zombies are dangerous.
</p>

<p>The total population count \( N=S(t)+Z(t) \) is regarded as constant in our simple
model, which means that we ignore phenomena such as birth, natural death,
immigration/emigration, etc.
Dividing both sides of the above equation with \( \Delta t \), and taking the
limit \( \Delta t\to 0 \), we find:
</p>
$$
\begin{align}
\tag{2}
\frac{\mathrm{d}S(t)}{\mathrm{d}t}&=-\beta\cdot\frac{S(t)Z(t)}{N}\\ 
\tag{3}
\frac{\mathrm{d}Z(t)}{\mathrm{d}t}&=\frac{\mathrm{d}(N-S)}{\mathrm{d}t}
= -\frac{\mathrm{d}S(t)}{\mathrm{d}t}
=\beta\cdot\frac{S(t)Z(t)}{N}\,.
\end{align}
$$

<p>Clearly, if there are no infected individuals at time zero, nothing will
happen later either. We shall therefore assume that
\( Z_{0}\equiv{Z(0)}\geq{1} \); typically \( Z_0=1 \).
</p>

<div class="alert alert-block alert-success alert-text-normal"><b><font color="white">Analytical solution:</font></b>
<p><font color="white">The analytical solution to the SZ-model, equations
\eqref{eq:SIR1</font>) and (ref{eq:SIR2}, is
</p>
$$
\begin{align}
\tag{4}
S(t)&=\frac{(S_0+Z_0)\frac{S_0}{Z_0}\exp(-\beta{t})}{1+\frac{S_0}{Z_0}\exp(-\beta{t})} \\ 
Z(t)&=\frac{S_0+Z_0}{1+\frac{S_0}{Z_0}\exp(-\beta{t})}
\,,
\tag{5}
\end{align}
$$

<p>where \( S_0=S(0) \), and thus \( S_0+Z_0=N \).}</p>
</div>

<h1 id="no_hope" class="anchor">Exercise 1: No hope?</h1>

<center>  <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 3: A view from Sokndal (left) and Dirdal (right).</p>
</center>
<p><img src="fig-project2/sd.png" width="800" align="bottom"></p>
</center>

<p>Sokndal and Dirdal are two small villages in Rogaland. Two scientists from
these places went to an international conference on numerical methods
in Haiti. During the conference, an excursion was arranged to a rural area,
and a strange tomato salad consisting of, among other things, pufferfish
venom, was served <a href="#davis2010serpent">[3]</a>.
After arriving back in Norway, both scientists got a fever, stopped eating,
and subsequently started to behave suspiciously.
</p>

<p>Dirdal has about 683 inhabitants, and Sokndal 3305 <a href="#snl">[4]</a>.
We want to use the SZ-model to investigate a potential zombie invasion in
these two places.
For the initial phase of the zombie outbreak, suppose that the two scientists
are staying with their closest family ( \( S \) = 2 ), that the duration of contact is
10 hours, and that there is a 20$\%$ chance of transmitting the infection to
the family members. From this, we estimate a value for \( \beta \) as follows:
</p>
$$
\begin{equation}
\beta\frac{Z}{N} \Delta{t}=\beta\frac{1}{3}\cdot{10}\text{ hours}=0.20\,,
\tag{6}
\end{equation}
$$

<p>from which we find \( \beta=0.06 \) 1/hr.</p>

<p>
<b>Task 1.</b>
Make a figure in which you compare <em>the fraction of the total population</em> that
are predicted to turn into zombies in the two locations, using the analytical
solution in equation <a href="#mjx-eqn-4">(4)</a>.
</p>

<p>
<b>Task 2.</b>
Find the critical points of the model, and explain why the entire human population will be eradicated and
turned into zombies in the limit \( t\rightarrow{\infty} \), regardless of the
value of \( \beta>0 \)!
</p>

<p>Hint: Rewrite equation <a href="#mjx-eqn-3">(3)</a>, using that \( S(t)=N-Z(t) \).</p>
<h1 id="exercise-2-numerical-solver-implementation" class="anchor">Exercise 2: Numerical solver implementation </h1>
<p>The SZ-model can be recast into the following general form:</p>
$$
\begin{equation}
\tag{7}
\frac{d\mathbf{y}}{dt}=\mathbf{f}(\mathbf{y},t)\,,
\end{equation}
$$

<p>where</p>
$$
\begin{align}
\mathbf{y}&=(S,Z) 
\tag{8}\\ 
\mathbf{f}(\mathbf{y},t)&=(-\beta S(t)Z(t),\beta S(t)Z(t))\,.
\tag{9}
\end{align}
$$

<p>Develop your own numerical solver(s) that can handle any system of ODEs of
the form <a href="#mjx-eqn-7">(7)</a>. This means that the right-hand side
\( \mathbf{f}(\mathbf{y},t) \) should be provided as an input argument to a
suitably defined Python function/class.
</p>

<p>
<b>Task 1.</b>
</p>

<p>Implement one of the following options:</p>
<ul>
<li> the Forward Euler Scheme</li>
<li> Runge-Kutta (2. or 4. order)</li>
<li> adaptive solver</li>
</ul>
<p>
<b>Task 2.</b>
</p>

<ul>
<li> Use your implementation to solve the SZ-model numerically. Test your code against the analytical solution, assuming \( \beta \) to be equal to the value we estimated above.</li>
<li> Play with the step size, i.e. make \( \Delta t \) progressive larger - explain what you observe</li>
</ul>
<h1 id="fate_of_dirdal_and_sokndal" class="anchor">Exercise 3: Predicting the fate of Sokndal and Dirdal</h1>

<p>Later on in a zombie outbreak, people become more aware and not so easily
fooled by the hordes of undead; after all, zombies are not known to
be particularly bright. To capture this behavior, the zombie-infection rate is now assumed to be time dependent and assumed to decline exponentially:
</p>
$$
\begin{equation}
\beta\to\beta(t)=\beta_0 e^{-\lambda t}.
\tag{10}
\end{equation}
$$

<p>We have introduced a new parameter \( \lambda \), that can be estimated as follows:
Suppose that after a specific time \( T \), the probability of getting
infected has been reduced to 60 \( \% \) of its initial value. We can then estimate \( \lambda \) from:
</p>
$$
\begin{equation}
e^{-\lambda T}=0.6,
\tag{11}
\end{equation}
$$

<p>from which it follows that</p>
$$
\begin{equation}
\lambda=-\frac{1}{T}\ln 0.6.
\tag{12}
\end{equation}
$$

<p>The updated model can be again be written in the form <a href="#mjx-eqn-7">(7)</a>,
the only difference now being that \( \beta=\beta(t) \) is time-dependent.
We shall consider two cases:
</p>

<ol>
<li> Sokndal outbreak: after 48 hours, the probability of being infected by a zombie has dropped to 60$\%$ of its initial value.</li>
<li> Dirdal outbreak: people are very tolerant to unorthodox behavior, which is usually a good thing, but here it has the consequence that it takes 72 hours before the probability of zombie infection drops to 60$\%$ of its initial value.</li>
</ol>
<p>
<b>Task 1.</b>
</p>

<ul>
<li> Estimate \( \lambda \) from the provided information about the Sokndal and Dirdal outbreaks.</li>
</ul>
<p>
<b>Task 2.</b>
</p>
<ul>
<li> Solve the SZ-model numerically, but this time replace the constant \( \beta \)-factor with the time-dependent \( \beta_0 e^{-\lambda t} \). Roughly how many people survive the zombie outbreak in the two locations now?</li>
</ul>
<h1 id="SIR_model" class="anchor">Exercise 4: Counter attacks - Kill them all?</h1>
<p>In our second model the humans might survive, but that is only because the
probability of being infected eventually drops to zero; the zombies are still
wandering around. Let us now refine our model further:
</p>
<ul>
<li> So far, we have assumed that bitten humans turn into zombies instantaneously. This is a conservative assumption, and seem to be supported by various movies and TV shows. However, other sources <a href="#brooks2003zombie">[5]</a> report that a latency / incubation period of about 24 hours may be realistic.</li>
<li> At any given time, we assume a certain number of zombies to be killed by the humans; they are thus effectively removed from both the human and the zombie populations.</li>
<li> To make it more realistic, we also allow the humans to perform violent attacks at regular time intervals <a href="#langtangen2013escaping">[6]</a></li>
</ul>
<center> <!-- figure label: --> <div id="fig:p3:seir"></div> <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 4: SEZR model.  <!-- caption label: fig:p3:seir --></p>
</center>
<p><img src="fig-project2/seir.png" width="800" align="bottom"></p>
</center>

<p>Translated to the language of mathematics, we now wish to solve a system
with <em>four</em> compartments, see figure <a href="#fig:p3:seir">4</a>
</p>
$$
\begin{align}
\tag{13}
\frac{\mathrm{d}S(t)}{\mathrm{d}t}&=-\beta(t)\cdot\frac{S(t)Z(t)}{N}\\ 
\tag{14}
\frac{\mathrm{d}E(t)}{\mathrm{d}t}&=\beta(t)\cdot\frac{S(t)Z(t)}{N}-\sigma\cdot{E(t)}\\ 
\tag{15}
\frac{\mathrm{d}Z(t)}{\mathrm{d}t}&=\sigma\cdot{E(t)}-(\alpha+\omega(t))\frac{S(t)Z(t)}{N}\\ 
\tag{16}
\frac{\mathrm{d}R(t)}{\mathrm{d}t}&=(\alpha+\omega(t))\frac{S(t)Z(t)}{N}\,.
\end{align}
$$

<p>The first new compartment, \( E(t) \), represents the class of exposed humans,
i.e., those that have been bitten or scratched by a zombie, but which still
remain non-contagious to others.
The parameter \( \sigma \) is the fraction of such people that turn into zombies
per unit time; alternatively, we may view \( 1/\sigma \) as the
<em>incubation time</em> of the zombie disease, and set it equal to \( 24 \) hrs.
</p>

<p>The second new compartment, \( R(t) \) represents killed (removed) zombies.
In the same way that a certain fraction of human-zombie encounters result in
transmission of the disease, a certain number of encounters also lead to the
human killing the zombie; in the model, the sum \( \alpha+\omega(t) \) is therefore
a measure of the probability that the zombie will have its brain
destroyed (or separated from its head).
Alternatively, \( 1/(\alpha+\omega(t)) \) may be viewed as the 'mean infectious
period' of the zombie disease. Note that \( \alpha \) is a constant factor, and
may be thought of as the background rate of zombie-killing.
On the other hand, the function
\( \omega=\omega(t) \) describe the violent attacks <a href="#langtangen2013escaping">[6]</a>.
</p>


<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #3D7B7B; font-style: italic"># attacks occur at specified times following the zombie outbreak:</span>
attacks <span style="color: #666666">=</span> [<span style="color: #666666">100</span>,<span style="color: #666666">124</span>,<span style="color: #666666">148</span>,<span style="color: #666666">172</span>,<span style="color: #666666">196</span>]  <span style="color: #3D7B7B; font-style: italic"># hrs</span>
a <span style="color: #666666">=</span> <span style="color: #666666">20*</span>beta

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">omega</span>(t, a, attacks):
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Zombie attack function</span>
<span style="color: #BA2121; font-style: italic">    Input</span>
<span style="color: #BA2121; font-style: italic">    -----</span>
<span style="color: #BA2121; font-style: italic">    t: float, time</span>
<span style="color: #BA2121; font-style: italic">    a: float, strength of attacks</span>
<span style="color: #BA2121; font-style: italic">    attacks: a list with times for attacks</span>

<span style="color: #BA2121; font-style: italic">    Output</span>
<span style="color: #BA2121; font-style: italic">    ------</span>
<span style="color: #BA2121; font-style: italic">    sys[0]: float</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">return</span> a<span style="color: #666666">*</span>np<span style="color: #666666">.</span>sum([np<span style="color: #666666">.</span>exp(<span style="color: #666666">-.5*</span>(t<span style="color: #666666">-</span>ti)<span style="color: #666666">**2</span>) <span style="color: #008000; font-weight: bold">for</span> ti <span style="color: #AA22FF; font-weight: bold">in</span> attacks])
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>In figure <a href="#fig:p3:wt">5</a>, the function \( \omega(t) \) is shown.
Changing the factor in front of <code>(t-ti)**2</code> changes the duration of the
attacks. The parameter <code>a</code> should be chosen to be much larger than \( \beta \),
because humans are much smarter than the zombies, and have more advanced
weapons.
</p>

<center> <!-- figure label: --> <div id="fig:p3:wt"></div> <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 5: Attack function.  <!-- caption label: fig:p3:wt --></p>
</center>
<p><img src="fig-project2/wt.png" width="800" align="bottom"></p>
</center>

<div class="alert alert-block alert-success alert-text-normal"><b><font color="white">The basic reproduction number \( \mathcal{R < /font>_0 \)}</b>
<p><font color="white">\( \mathcal{R < /font>_0 \), can be thought of as a
number which determine whether a disease can spread through the
population (<em>very</em> important for <em>ebola, HIV, polio, etc</em>).
It represents the average number of new infected cases produced, in an entirely
susceptible population, by a typical infected
individual <a href="#diekmann1990definition">[7]</a>.
In our model, it is a good approximation to define it as
</p>
$$
\begin{equation}
\tag{17}
\mathcal{R}_0\simeq\frac{\beta(t)}{\alpha + \omega(t)}.
\end{equation}
$$

<p>Thus, if \( \mathcal{R}_0>1 \) we have a zombie apocalypse.}</p>
</div>


<p>
<b>Task 1.</b>
</p>

<ul>
<li> Assume \( \omega(t)=0 \), and \( \beta = constant \), choose suitable value for \( \alpha \). Run a couple of simulations (choose Sokndal or Dirdal). Is it possible to survive the zombie apocalypse if \( \beta/\alpha >1 \)?</li>
</ul>
<p>
<b>Task 2.</b>
</p>

<ul>
<li> Assume \( \beta = constant \), turn on violent attacks (i.e. use <code>omega(t, a, attacks)</code> as defined above). Is it now possible to survive if \( \beta/\alpha>1 \)?</li>
</ul>
<div class="alert alert-block alert-success alert-text-normal"><b><font color="white">if \( Z(t) < 1 \) and \( E(t) < 1 \)</font></b>
<p><font color="white">If the number of zombies or infected drops below one, it makes
sense to set \( \beta \) and \( \sigma \) $\to0$. There is no such thing as a
fractional zombie or human.</font>
</p>
</div>

<h1 id="ebola" class="anchor">Exercise 5: Ebola epidemic in West Africa</h1>

<p>Finally, we want to adapt our model to handle the case of the Ebola virus.
Data for Ebola outbreaks are freely available at the website of the
<a href="https://www.who.int" target="_self">World Health Organization</a> (WHO), and a subset of
the data have been stored in a more convenient format in the following text
files:
</p>
<ul>
<li> <code>ebola_cases_guinea.dat</code></li>
<li> <code>ebola_cases_liberia.dat</code></li>
<li> <code>ebola_cases_sierra_leone.dat</code></li>
</ul>
<p>In each of these files, the third column contains reported new
cases (confirmed+probable) of the Ebola virus in the given country.
For completeness and to avoid confusion, we present the equations to be
used here:
</p>
$$
\begin{align}
\tag{18}
\frac{\mathrm{d}S(t)}{\mathrm{d}t}&=-\beta(t)\cdot\frac{S(t)Z(t)}{N}\\ 
\tag{19}
\frac{\mathrm{d}E(t)}{\mathrm{d}t}&=\beta(t)\cdot\frac{S(t)Z(t)}{N}-\sigma\cdot{E(t)}\\ 
\tag{20}
\frac{\mathrm{d}Z(t)}{\mathrm{d}t}&=\sigma\cdot{E(t)}-\gamma Z(t)\\ 
\tag{21}
\frac{\mathrm{d}R(t)}{\mathrm{d}t}&=\gamma Z(t).\\ 
\tag{22}
\end{align}
$$

<p>These equations are very similar to equations <a href="#mjx-eqn-13">(13)</a>-<a href="#mjx-eqn-16">(16)</a>.
However, the compartment \( Z \) now represents people infected
with the Ebola virus. Also, \( R \) represents previously infected
people that have either 1) recovered (become immune), or 2) died.
For simplicity, we do not distinguish between these two above alternatives;
persons in both categories are assumed to not have any bearing on whether
the virus will continue to spread.
Accordingly, we model the rate of 'removal' from the Z-compartment with a
term \( \gamma Z \), in which the constant \( 1/\gamma \) is the average time until
recovery/death (mean infectious period). As done previously, we compute
\( \beta \) from
</p>
$$
\begin{equation}
\beta(t)=\beta_0e^{-\lambda t},
\tag{23}
\end{equation}
$$

<p>where \( \beta_0 \) and \( \lambda \) are <em>unknown</em> parameters; they need to be
determined from data.
</p>

<p>
<b>Task 1.</b>
For each of the three West African countries, make a figure in which you
plot
</p>

<ul>
<li> the number of new cases of Ebola registered at any given moment in time, and the cumulative amount.</li>
</ul>
<p>If done correctly, the end result for Guinea should look something
like figure <a href="#fig:ebola_guinea">6</a>.
</p>

<center> <!-- figure label: --> <div id="fig:ebola_guinea"></div> <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 6: Outbreak of the Ebola virus in Guinea, 2014-2015.  <!-- caption label: fig:ebola_guinea --></p>
</center>
<p><img src="fig-project2/ebola_guinea.png" width="800" align="bottom"></p>
</center>

<div class="alert alert-block alert-success alert-text-normal"><b><font color="white">Ebola parameters</font></b>
<p><font color="white">It has been estimated that the average infectious period for
the Ebola virus is one week, and that the latency period is
9.7 days <a href="#wong2017systematic">[8]</a>, hence \( 1/\gamma=7 \) days, and \( 1/\sigma=9.7 \) days.
Assuming these parameters to be valid, we want to fit the four-compartment model
with an exponentially decaying \( \beta \)-factor to the data.
For simplicity, we will assume a fixed population size of \( N=10^7 \) in all
three countries; the exact value should not be that important as long as
\( S(t)\approx{N < /font> \).}
</p>
</div>


<p>
<b>Task 2.</b>
</p>

<p>For the case of Guinea, experiment manually by varying \( \beta_0 \) and \( \lambda \)
until the model produces something that resembles
figure <a href="#fig:ebola_guinea">6</a>.
</p>

<p>
<b>Part 3. (OPTIONAL!!)</b>
Next, we want to use an automatic optimization method to fit the model to the
data for all three countries. One possibility
is to use <a href="https://docs.scipy.org/doc/scipy-0.18.1/reference/generated/scipy.optimize.curve_fit.html" target="_self"><tt>scipy.optimize.curve_fit</tt></a>.
You may for example take the following Python code as a starting point:
</p>


<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #3D7B7B; font-style: italic"># To do: store time in days in array t</span>
<span style="color: #3D7B7B; font-style: italic"># To do: store cumulative number of Ebola cases in array Ct</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">non_linear_func</span>(t, beta0, lam):
    <span style="color: #3D7B7B; font-style: italic"># To do:</span>
    <span style="color: #3D7B7B; font-style: italic"># Solve system of ODEs and return cumulative number of</span>
    <span style="color: #3D7B7B; font-style: italic"># outbreaks at each time t.</span>
    <span style="color: #008000; font-weight: bold">pass</span>
bds <span style="color: #666666">=</span> ((<span style="color: #666666">0.0</span>, <span style="color: #666666">0.0</span>), (np<span style="color: #666666">.</span>inf, np<span style="color: #666666">.</span>inf))
popt, pcov <span style="color: #666666">=</span> sp<span style="color: #666666">.</span>optimize<span style="color: #666666">.</span>curve_fit(non_linear_func, t, Ct, bounds<span style="color: #666666">=</span>bds)
<span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;Curve-fit: beta0=</span><span style="color: #A45A77; font-weight: bold">{}</span><span style="color: #BA2121">, lambda=</span><span style="color: #A45A77; font-weight: bold">{}</span><span style="color: #BA2121">.&#39;</span><span style="color: #666666">.</span>format(popt[<span style="color: #666666">0</span>], popt[<span style="color: #666666">1</span>]))
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>For each country, make a plot like figure <a href="#fig:ebola_guinea">6</a> in which
you compare the model to the data.
</p>

<div class="alert alert-block alert-success alert-text-normal"><b><font color="white">Note:</font></b>
<p><font color="white">For Liberia, the number of reported outbreaks are very sporadic initially.
Therefore, you might need to start counting days at a later date than what
is done in the text file.</font>
</p>
</div>

<h1 id="guidelines-for-project-submission" class="anchor">Guidelines for project submission </h1>

<p>You should bear the following points in mind when working on the project:</p>
<ul>
<li> Start your notebook by providing a short introduction in which you outline the nature of the problem(s) to be investigated.</li>
<li> End your notebook with a brief summary of what you feel you learned from the project (if anything). Also, if you have any general comments or suggestions for what could be improved in future assignments, this is the place to do it.</li>
<li> All code that you make use of should be present in the notebook, and it should ideally execute without any errors (especially run-time errors). If you are not able to fix everything before the deadline, you should give your best understanding of what is not working, and how you might go about fixing it.</li>
<li> Avoid duplicating code! If you find yourself copying and pasting a lot of code, it is a strong indication that you should define reusable functions and/or classes.</li>
<li> If you use an algorithm that is not fully described in the assignment text, you should try to explain it in your own words. This also applies if the method is described elsewhere in the course material.</li>
<li> In some cases it may suffice to explain your work via comments in the code itself, but other times you might want to include a more elaborate explanation in terms of, e.g., mathematics and/or pseudocode.</li>
<li> In general, it is a good habit to comment your code (though it can be overdone).</li>
<li> When working with approximate solutions to equations, it is very useful to check your results against known exact (analytical) solutions, should they be available.</li>
<li> It is also a good test of a model implementation to study what happens at known 'edge cases'.</li>
<li> Any figures you include should be easily understandable. You should label axes appropriately, and depending on the problem, include other legends etc. Also, you should discuss your figures in the main text.</li>
<li> It is always good if you can reflect a little bit around <em>why</em> you see what you see.</li>
</ul>
<h1 id="bibliography" class="anchor">Bibliography </h1>

<!-- begin bibliography -->
<ol>
 <li> <div id="kermack1927contribution"></div> <b>W. O. Kermack and A. G. McKendrick</b>.  A Contribution to the Mathematical Theory of Epidemics—I, <em>Proceedings of the Royal Society of London. Series A, Containing papers of a mathematical and physical character</em>, 115(772), pp. 700-721, 1927.</li>
 <li> <div id="begon2002clarification"></div> <b>M. Begon, M. Bennett, R. G. Bowers, N. P. French, S. Hazel and J. Turner</b>.  A Clarification of Transmission Terms in Host-Microparasite Models: Numbers, Densities and Areas, <em>Epidemiology &amp; Infection</em>, 129(1), pp. 147-153, 2002.</li>
 <li> <div id="davis2010serpent"></div> <b>W. Davis</b>.  <em>The Serpent and the Rainbow</em>, New York: Simon and Schuster, 2010.</li>
 <li> <div id="snl"></div> Store Norske Leksikon.  Accessed: 2019-10-24, <a href="https://snl.no" target="_self"><tt>https://snl.no</tt></a>.</li>
 <li> <div id="brooks2003zombie"></div> <b>M. Brooks</b>.  <em>The Zombie Survival Guide: Complete Protection From the Living Dead</em>, Broadway books, 2003.</li>
 <li> <div id="langtangen2013escaping"></div> <b>H. P. Langtangen, K.-A. Mardal and P. Røtnes</b>.  Escaping the Zombie Threat by Mathematics, <em>Zombies in the Academy-Living Death in Higher Education</em>, 2013.</li>
 <li> <div id="diekmann1990definition"></div> <b>O. Diekmann, J. A. P. Heesterbeek and J. A. Metz</b>.  On the Definition and the Computation of the Basic Reproduction Ratio R0 in Models for Infectious Diseases in Heterogeneous Populations, <em>Journal of mathematical biology</em>, 28(4), pp. 365-382, 1990.</li>
 <li> <div id="wong2017systematic"></div> <b>Z. Wong, C. Bui, A. Chughtai and C. Macintyre</b>.  A Systematic Review of Early Modelling Studies of Ebola Virus Disease in West Africa, <em>Epidemiology &amp; Infection</em>, 145(6), pp. 1069-1094, 2017.</li>
</ol>
<!-- end bibliography -->
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
  <li class="previous">
    <a href="._project2-readable000.html">&larr; Prev</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->
</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
<!-- Bootstrap footer
<footer>
<a href="https://..."><img width="250" align=right src="https://..."></a>
</footer>
-->
</body>
</html>

